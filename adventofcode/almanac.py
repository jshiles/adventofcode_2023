"""
Classes and configuration for Day 05.
"""

from dataclasses import dataclass
from typing import List, FrozenSet


@dataclass(frozen=True)
class Mapping:
    destination: int
    source: int
    range: int

    def valid_source_number(self, source: int) -> bool:
        """does this mapping correspond to this source number?"""
        return self.source <= source < self.source + self.range

    def valid_destination_number(self, destination: int) -> bool:
        """does this mapping correspond to this source number?"""
        return self.destination <= destination < self.destination + self.range

    def source_to_destination(self, source: int) -> int:
        """Given source X, what is the corresponding destination?"""
        if self.valid_source_number(source):
            return (source - self.source) + self.destination
        else:
            raise ValueError(f"Source {source} is out of range.")

    def destination_to_source(self, destination: int) -> int:
        """Given destination X, what is the corresponding soil?"""
        if self.valid_destination_number(destination):
            return (destination - self.destination) + self.source
        else:
            raise ValueError(f"Destination {destination} is out of range.")


@dataclass(frozen=True)
class SeedRange:
    seed: int
    range: int

    def in_range(self, seed) -> bool:
        return self.seed <= seed < self.seed + self.range


SEED_TO_SOIL: FrozenSet[Mapping] = frozenset([
    # Mapping(50, 98, 2),
    # Mapping(52, 50, 48),
    Mapping(3566547172, 3725495029, 569472267),
    Mapping(2346761246, 1249510998, 267846697),
    Mapping(1812605508, 937956667, 271194541),
    Mapping(1421378697, 1209151208, 40359790),
    Mapping(2083800049, 2788751092, 262961197),
    Mapping(2938601691, 473979048, 463977619),
    Mapping(473979048, 1517357695, 947399649),
    Mapping(4136019439, 3566547172, 158947857),
    Mapping(1461738487, 3051712289, 350867021),
    Mapping(2614607943, 2464757344, 323993748),
])

SOIL_TO_FERTILIZER: FrozenSet[Mapping] = frozenset([
    # Mapping(0, 15, 37),
    # Mapping(37, 52, 2),
    # Mapping(39, 0, 15),
    Mapping(3107230831, 2583931429, 576709409),
    Mapping(970181981, 608291332, 1441137369),
    Mapping(743954495, 3859046283, 158951815),
    Mapping(3683940240, 3227916509, 91282070),
    Mapping(608291332, 2448268266, 135663163),
    Mapping(3775222310, 2049428701, 398839565),
    Mapping(2411319350, 3319198579, 539847704),
    Mapping(2951167054, 4017998098, 156063777),
    Mapping(902906310, 3160640838, 67275671),
])

FERTILIZER_TO_WATER: FrozenSet[Mapping] = frozenset([
    # Mapping(49, 53, 8),
    # Mapping(0, 11, 42),
    # Mapping(42, 0, 7),
    # Mapping(57, 7, 4),
    Mapping(1257642402, 395703749, 69589612),
    Mapping(1800674, 2215701547, 90550534),
    Mapping(2757853693, 358464863, 37238886),
    Mapping(3285451399, 181079109, 43937782),
    Mapping(2346544130, 3513448371, 192150886),
    Mapping(3866348216, 4231433060, 63534236),
    Mapping(1327232014, 1560332334, 90281838),
    Mapping(2538695016, 616206288, 114467702),
    Mapping(255018176, 225016891, 46372244),
    Mapping(1171065990, 3705599257, 27021880),
    Mapping(1070753744, 730673990, 442780),
    Mapping(221369008, 3479799203, 33649168),
    Mapping(2987721226, 271389135, 80072982),
    Mapping(1198087870, 732917444, 24556356),
    Mapping(199036270, 2306252081, 22332738),
    Mapping(0, 731116770, 1800674),
    Mapping(3929882452, 3989920675, 212758268),
    Mapping(631506549, 757473800, 322942578),
    Mapping(301390420, 0, 157952443),
    Mapping(2795092579, 157952443, 1997721),
    Mapping(1222644226, 2619085211, 34998176),
    Mapping(954449127, 499901671, 116304617),
    Mapping(1429766246, 159950164, 21128945),
    Mapping(2205492221, 2074649638, 141051909),
    Mapping(2749302577, 3732621137, 8551116),
    Mapping(459342863, 1219863414, 57737723),
    Mapping(3329389181, 3741172253, 59047790),
    Mapping(2797090300, 2328584819, 190630926),
    Mapping(3278448653, 351462117, 7002746),
    Mapping(126959518, 1277601137, 72076752),
    Mapping(92351208, 465293361, 34608310),
    Mapping(4142640720, 3866348216, 123572459),
    Mapping(2143980560, 1080416378, 43307177),
    Mapping(1450895191, 2672287871, 693085369),
    Mapping(517080586, 3365373240, 114425963),
    Mapping(3388436971, 1662866566, 411783072),
    Mapping(2187287737, 2654083387, 18204484),
    Mapping(1417513852, 1650614172, 12252394),
    Mapping(3067794208, 1349677889, 210654445),
    Mapping(4266213179, 4202678943, 28754117),
    Mapping(2653162718, 1123723555, 96139859),
    Mapping(1071196524, 2519215745, 99869466),
])

WATER_TO_LIGHT: FrozenSet[Mapping] = frozenset([
    # Mapping(88, 18, 7),
    # Mapping(18, 25, 70),
    Mapping(512627839, 90187036, 1196629),
    Mapping(3379634653, 2059506154, 33434334),
    Mapping(3286651054, 4276482087, 18485209),
    Mapping(4233695090, 28914830, 61272206),
    Mapping(3413068987, 3322576776, 23288997),
    Mapping(3736304424, 3345865773, 43267308),
    Mapping(1246285471, 2994853001, 251748584),
    Mapping(3779571732, 1946298040, 113208114),
    Mapping(390808412, 3287769466, 34807310),
    Mapping(1881283842, 2879009693, 106527924),
    Mapping(3964031050, 2506138169, 12994476),
    Mapping(3436357984, 793897944, 162691614),
    Mapping(2255160753, 2092940488, 151061610),
    Mapping(853985057, 3506201042, 119010035),
    Mapping(301385394, 1856875022, 89423018),
    Mapping(972995092, 658665705, 34308693),
    Mapping(4159948022, 1315925500, 65322692),
    Mapping(640912738, 250463411, 213072319),
    Mapping(1761800914, 91383665, 102591221),
    Mapping(450345319, 3246601585, 5793995),
    Mapping(3186220306, 4173678310, 91115364),
    Mapping(28914830, 3633635453, 176360375),
    Mapping(456139314, 193974886, 56488525),
    Mapping(2523290324, 3809995828, 187303152),
    Mapping(2406222363, 3389133081, 117067961),
    Mapping(205275205, 2782899504, 96110189),
    Mapping(2135785589, 1100569535, 119375164),
    Mapping(1121466033, 533846267, 124819438),
    Mapping(1007303785, 2244002098, 114162248),
    Mapping(3599049598, 3997298980, 137254826),
    Mapping(4077949072, 463535730, 70310537),
    Mapping(4225270714, 3625211077, 8424376),
    Mapping(1498034055, 2519132645, 263766859),
    Mapping(2710593476, 1381248192, 475626830),
    Mapping(3977025526, 692974398, 100923546),
    Mapping(4148259609, 4264793674, 11688413),
    Mapping(1987811766, 2358164346, 147973823),
    Mapping(3892779846, 1244674296, 71251204),
    Mapping(3340510149, 4134553806, 39124504),
    Mapping(1864392135, 956589558, 16891707),
    Mapping(425615722, 1219944699, 24729597),
    Mapping(513824468, 973481265, 127088270),
    Mapping(3277335670, 2985537617, 9315384),
    Mapping(3305136263, 3252395580, 35373886),
])

LIGHT_TO_TEMPERATURE: FrozenSet[Mapping] = frozenset([
    # Mapping(45, 77, 23),
    # Mapping(81, 45, 19),
    # Mapping(68, 64, 13),
    Mapping(1094191559, 698410082, 28110394),
    Mapping(383870732, 1189042355, 107231661),
    Mapping(3711052230, 2164474756, 34756304),
    Mapping(745558539, 170241759, 7170863),
    Mapping(491102393, 503970250, 194439832),
    Mapping(4034618875, 3142749029, 146609939),
    Mapping(3781998432, 1718948669, 129329785),
    Mapping(2440091414, 3071819711, 70929318),
    Mapping(1301358031, 55123603, 115118156),
    Mapping(0, 2789116652, 87933685),
    Mapping(770729148, 177412622, 48955790),
    Mapping(3772681560, 3886204605, 9316872),
    Mapping(752729402, 37123857, 17999746),
    Mapping(3745808534, 2137385460, 7147939),
    Mapping(2028807236, 3677936618, 208267987),
    Mapping(2237075223, 3289358968, 92979022),
    Mapping(88764920, 1960439220, 176946240),
    Mapping(3568470355, 2258695303, 142581875),
    Mapping(3276170082, 1848278454, 112160766),
    Mapping(2637902204, 1129503077, 39814191),
    Mapping(3000547589, 892603630, 188042422),
    Mapping(2511020732, 226368412, 126881472),
    Mapping(1122301953, 1296274016, 52818372),
    Mapping(1440958847, 1353023078, 243104929),
    Mapping(2963423732, 0, 37123857),
    Mapping(3388330848, 2199231060, 48304954),
    Mapping(1175120325, 377732544, 126237706),
    Mapping(819684938, 1349092388, 3930690),
    Mapping(3752956473, 1169317268, 19725087),
    Mapping(3911328217, 2144533399, 19941357),
    Mapping(1416476187, 353249884, 24482660),
    Mapping(2677716395, 3895521477, 285707337),
    Mapping(265711160, 2413138935, 118159572),
    Mapping(685542225, 1080646052, 48857025),
    Mapping(3556608598, 2401277178, 11861757),
    Mapping(734399250, 2247536014, 11159289),
    Mapping(87933685, 3677105383, 831235),
    Mapping(3188590011, 1596128007, 87580071),
    Mapping(836373414, 2531298507, 257818145),
    Mapping(3471876393, 2877050337, 84732205),
    Mapping(1684063776, 726520476, 166083154),
    Mapping(823615628, 3560998296, 12757786),
    Mapping(3436635802, 1683708078, 35240591),
    Mapping(3931269574, 3573756082, 103349301),
    Mapping(1850146930, 3382337990, 178660306),
    Mapping(2330054245, 2961782542, 110037169),
])

TEMPERATURE_TO_HUMIDITY: FrozenSet[Mapping] = frozenset([
    # Mapping(0, 69, 1),
    # Mapping(1, 0, 69),
    Mapping(1773059646, 4122818507, 172148789),
    Mapping(2417158855, 2859734866, 110076859),
    Mapping(977168274, 1576624124, 28149321),
    Mapping(4275291678, 3797606290, 19675618),
    Mapping(1141296808, 749646180, 267286171),
    Mapping(3592756112, 2969811725, 273274339),
    Mapping(0, 19621130, 7167651),
    Mapping(2059084943, 2697725300, 48133058),
    Mapping(2107218001, 3920609496, 145140777),
    Mapping(1453481278, 1152911564, 151292167),
    Mapping(1408582979, 1465584228, 44898299),
    Mapping(7167651, 0, 19621130),
    Mapping(2907567891, 1829621431, 240604380),
    Mapping(2252358778, 3652347291, 145258999),
    Mapping(1005317595, 1016932351, 135979213),
    Mapping(1945208435, 2745858358, 113876508),
    Mapping(2397617777, 4065750273, 16506015),
    Mapping(3251499859, 1776094709, 53526722),
    Mapping(2867005672, 4082256288, 40562219),
    Mapping(26788781, 1304203731, 161380497),
    Mapping(3305026581, 2409995769, 287729531),
    Mapping(3866030451, 3243086064, 409261227),
    Mapping(2414123792, 1773059646, 3035063),
    Mapping(911026677, 1510482527, 66141597),
    Mapping(3148172271, 3817281908, 103327588),
    Mapping(2527235714, 2070225811, 339769958),
    Mapping(188169278, 26788781, 722857399),
])

HUMIDITY_TO_LOCATION: FrozenSet[Mapping] = frozenset([
    # Mapping(60, 56, 37),
    # Mapping(56, 93, 4),
    Mapping(3907319746, 3137303541, 31421983),
    Mapping(3085093695, 1018495475, 286155292),
    Mapping(2898003508, 2491485887, 87665522),
    Mapping(2546787368, 2901838353, 7997221),
    Mapping(3835317650, 2829836257, 72002096),
    Mapping(2554784589, 3509894030, 133012322),
    Mapping(3487595595, 3719561871, 104747874),
    Mapping(3714670750, 2667334372, 120646900),
    Mapping(975094571, 2909835574, 227467967),
    Mapping(2985669030, 3864000834, 99424665),
    Mapping(3672962118, 2449777255, 41708632),
    Mapping(3631107133, 2787981272, 41854985),
    Mapping(3938741729, 3963425499, 15057061),
    Mapping(3447904506, 3824309745, 39691089),
    Mapping(1824175159, 1304650767, 641793976),
    Mapping(242892183, 0, 6504921),
    Mapping(3371248987, 3642906352, 76655519),
    Mapping(1698833898, 2258930589, 81940357),
    Mapping(0, 6504921, 242892183),
    Mapping(2465969135, 3978482560, 80818233),
    Mapping(3592343469, 4256203632, 38763664),
    Mapping(3953798790, 3168725524, 341168506),
    Mapping(2775979874, 4134179998, 122023634),
    Mapping(1780774255, 975094571, 43400904),
    Mapping(1311468847, 1946444743, 312485846),
    Mapping(2687796911, 2579151409, 88182963),
    Mapping(1202562538, 2340870946, 108906309),
    Mapping(1623954693, 4059300793, 74879205),
])
